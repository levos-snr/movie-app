{"ast":null,"code":"\"use strict\";\n\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"exports\", \"react\", \"prop-types\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(exports, require(\"react\"), require(\"prop-types\"));\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports, global.React, global.propTypes);\n    global.undefined = mod.exports;\n  }\n})(void 0, function (exports, _react, _propTypes) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = undefined;\n\n  var _react2 = _interopRequireDefault(_react);\n\n  var _propTypes2 = _interopRequireDefault(_propTypes);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _typeof(obj) {\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  var TextTruncate = function (_Component) {\n    _inherits(TextTruncate, _Component);\n\n    function TextTruncate() {\n      var _getPrototypeOf2;\n\n      var _this;\n\n      _classCallCheck(this, TextTruncate);\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TextTruncate)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n      _defineProperty(_assertThisInitialized(_this), \"onResize\", function () {\n        if (_this.rafId) {\n          window.cancelAnimationFrame(_this.rafId);\n        }\n\n        _this.rafId = window.requestAnimationFrame(_this.update.bind(_assertThisInitialized(_this)));\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"onToggled\", function (truncated) {\n        typeof _this.props.onToggled === 'function' && setTimeout(function () {\n          return _this.props.onToggled(truncated);\n        }, 0);\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"onTruncated\", function () {\n        typeof _this.props.onTruncated === 'function' && setTimeout(function () {\n          return _this.props.onTruncated();\n        }, 0);\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"onCalculated\", function () {\n        typeof _this.props.onCalculated === 'function' && setTimeout(function () {\n          return _this.props.onCalculated();\n        }, 0);\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"update\", function () {\n        var style = window.getComputedStyle(_this.scope);\n        var font = [style['font-weight'], style['font-style'], style['font-size'], style['font-family'], style['letter-spacing']].join(' ');\n        _this.canvas.font = font;\n\n        _this.forceUpdate();\n      });\n\n      return _this;\n    }\n\n    _createClass(TextTruncate, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        var canvas = document.createElement('canvas');\n        var docFragment = document.createDocumentFragment();\n        var style = window.getComputedStyle(this.scope);\n        var font = [style['font-weight'], style['font-style'], style['font-size'], style['font-family']].join(' ');\n        docFragment.appendChild(canvas);\n        this.canvas = canvas.getContext('2d');\n        this.canvas.font = font;\n        this.forceUpdate();\n        window.addEventListener('resize', this.onResize);\n      }\n    }, {\n      key: \"componentWillUnmount\",\n      value: function componentWillUnmount() {\n        window.removeEventListener('resize', this.onResize);\n\n        if (this.rafId) {\n          window.cancelAnimationFrame(this.rafId);\n        }\n      }\n    }, {\n      key: \"measureWidth\",\n      value: function measureWidth(text) {\n        return Math.ceil(this.canvas.measureText(text).width);\n      }\n    }, {\n      key: \"getRenderText\",\n      value: function getRenderText() {\n        var _this$props = this.props,\n            containerClassName = _this$props.containerClassName,\n            element = _this$props.element,\n            line = _this$props.line,\n            onCalculated = _this$props.onCalculated,\n            onTruncated = _this$props.onTruncated,\n            onToggled = _this$props.onToggled,\n            text = _this$props.text,\n            textElement = _this$props.textElement,\n            textTruncateChild = _this$props.textTruncateChild,\n            truncateText = _this$props.truncateText,\n            maxCalculateTimes = _this$props.maxCalculateTimes,\n            props = _objectWithoutProperties(_this$props, [\"containerClassName\", \"element\", \"line\", \"onCalculated\", \"onTruncated\", \"onToggled\", \"text\", \"textElement\", \"textTruncateChild\", \"truncateText\", \"maxCalculateTimes\"]);\n\n        var scopeWidth = this.scope.getBoundingClientRect().width; // return if display:none\n\n        if (scopeWidth === 0) {\n          return null;\n        } // return if all of text can be displayed\n\n\n        if (scopeWidth >= this.measureWidth(text)) {\n          this.onToggled(false);\n          return (0, _react.createElement)(textElement, props, text);\n        }\n\n        var childText = '';\n\n        if (textTruncateChild && typeof textTruncateChild.type === 'string') {\n          var type = textTruncateChild.type;\n\n          if (type.indexOf('span') >= 0 || type.indexOf('a') >= 0) {\n            childText = textTruncateChild.props.children;\n          }\n        }\n\n        var currentPos = 1;\n        var maxTextLength = text.length;\n        var truncatedText = '';\n        var splitPos = 0;\n        var startPos = 0;\n        var displayLine = line;\n        var width = 0;\n        var lastIsEng = false;\n        var isPrevLineWithoutSpace = false;\n        var lastPos = 0;\n        var lastSpaceIndex = -1;\n        var ext = '';\n        var loopCnt = 0;\n\n        while (displayLine-- > 0) {\n          ext = displayLine ? '' : truncateText + (childText ? ' ' + childText : '');\n\n          while (currentPos <= maxTextLength) {\n            truncatedText = text.substr(startPos, currentPos);\n            width = this.measureWidth(truncatedText + ext);\n\n            if (width < scopeWidth) {\n              splitPos = text.indexOf(' ', currentPos + 1);\n\n              if (splitPos === -1) {\n                currentPos += 1;\n                lastIsEng = false;\n              } else {\n                lastIsEng = true;\n                currentPos = splitPos;\n              }\n            } else {\n              do {\n                if (loopCnt++ >= maxCalculateTimes) {\n                  break;\n                }\n\n                truncatedText = text.substr(startPos, currentPos);\n\n                if (!displayLine) {\n                  currentPos--;\n                }\n\n                if (truncatedText[truncatedText.length - 1] === ' ') {\n                  truncatedText = text.substr(startPos, currentPos - 1);\n                }\n\n                if (lastIsEng) {\n                  lastSpaceIndex = truncatedText.lastIndexOf(' ');\n\n                  if (lastSpaceIndex > -1) {\n                    currentPos = lastSpaceIndex;\n\n                    if (displayLine) {\n                      currentPos++;\n                    }\n\n                    truncatedText = text.substr(startPos, currentPos);\n                  } else {\n                    currentPos--;\n                    truncatedText = text.substr(startPos, currentPos);\n                  }\n                } else {\n                  currentPos--;\n                  truncatedText = text.substr(startPos, currentPos);\n                }\n\n                width = this.measureWidth(truncatedText + ext);\n              } while (width >= scopeWidth && truncatedText.length > 0);\n\n              startPos += currentPos;\n              break;\n            }\n          }\n\n          if (currentPos >= maxTextLength) {\n            startPos = maxTextLength;\n            break;\n          }\n\n          if (lastIsEng && !isPrevLineWithoutSpace && text.substr(lastPos, currentPos).indexOf(' ') === -1) {\n            isPrevLineWithoutSpace = text.substr(lastPos, currentPos).indexOf(' ') === -1;\n            displayLine--;\n          }\n\n          lastPos = currentPos + 1;\n        }\n\n        if (startPos === maxTextLength) {\n          this.onToggled(false);\n          return (0, _react.createElement)(textElement, props, text);\n        }\n\n        this.onTruncated();\n        this.onToggled(true);\n        return _react2[\"default\"].createElement(\"span\", props, (0, _react.createElement)(textElement, props, text.substr(0, startPos) + truncateText + ' '), textTruncateChild);\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var _this2 = this;\n\n        var _this$props2 = this.props,\n            element = _this$props2.element,\n            text = _this$props2.text,\n            _this$props2$style = _this$props2.style,\n            style = _this$props2$style === void 0 ? {} : _this$props2$style,\n            containerClassName = _this$props2.containerClassName,\n            line = _this$props2.line,\n            onCalculated = _this$props2.onCalculated,\n            onTruncated = _this$props2.onTruncated,\n            onToggled = _this$props2.onToggled,\n            textElement = _this$props2.textElement,\n            textTruncateChild = _this$props2.textTruncateChild,\n            truncateText = _this$props2.truncateText,\n            maxCalculateTimes = _this$props2.maxCalculateTimes,\n            props = _objectWithoutProperties(_this$props2, [\"element\", \"text\", \"style\", \"containerClassName\", \"line\", \"onCalculated\", \"onTruncated\", \"onToggled\", \"textElement\", \"textTruncateChild\", \"truncateText\", \"maxCalculateTimes\"]);\n\n        var fontWeight = style.fontWeight,\n            fontStyle = style.fontStyle,\n            fontSize = style.fontSize,\n            fontFamily = style.fontFamily;\n        var renderText = this.scope && line ? this.getRenderText() : (0, _react.createElement)(textElement, props, text);\n        ;\n        var rootProps = {\n          ref: function ref(el) {\n            _this2.scope = el;\n          },\n          className: containerClassName,\n          style: {\n            overflow: 'hidden',\n            fontWeight: fontWeight,\n            fontStyle: fontStyle,\n            fontSize: fontSize,\n            fontFamily: fontFamily\n          }\n        };\n        this.scope && this.onCalculated();\n        return (0, _react.createElement)(element, rootProps, renderText);\n      }\n    }]);\n\n    return TextTruncate;\n  }(_react.Component);\n\n  _defineProperty(TextTruncate, \"propTypes\", {\n    containerClassName: _propTypes2[\"default\"].string,\n    element: _propTypes2[\"default\"].string,\n    line: _propTypes2[\"default\"].oneOfType([_propTypes2[\"default\"].number, _propTypes2[\"default\"].bool]),\n    onCalculated: _propTypes2[\"default\"].func,\n    onTruncated: _propTypes2[\"default\"].func,\n    onToggled: _propTypes2[\"default\"].func,\n    text: _propTypes2[\"default\"].string,\n    textElement: _propTypes2[\"default\"].node,\n    textTruncateChild: _propTypes2[\"default\"].node,\n    truncateText: _propTypes2[\"default\"].string,\n    maxCalculateTimes: _propTypes2[\"default\"].number\n  });\n\n  _defineProperty(TextTruncate, \"defaultProps\", {\n    element: 'div',\n    line: 1,\n    text: '',\n    textElement: 'span',\n    truncateText: '…',\n    maxCalculateTimes: 10\n  });\n\n  exports.default = TextTruncate;\n  ;\n  module.exports = exports.default;\n});","map":{"version":3,"sources":["/home/lewis/papareact-challenge/papareact-day3/node_modules/react-text-truncate/lib/index.js"],"names":["global","factory","define","amd","exports","require","mod","React","propTypes","undefined","_react","_propTypes","Object","defineProperty","value","default","_react2","_interopRequireDefault","_propTypes2","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","key","i","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","propertyIsEnumerable","call","sourceKeys","keys","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","_assertThisInitialized","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","ReferenceError","_inherits","subClass","superClass","create","_setPrototypeOf","p","_defineProperty","TextTruncate","_Component","_getPrototypeOf2","_this","_len","arguments","args","Array","_key","apply","concat","rafId","window","cancelAnimationFrame","requestAnimationFrame","update","bind","truncated","onToggled","setTimeout","onTruncated","onCalculated","style","getComputedStyle","scope","font","join","canvas","forceUpdate","componentDidMount","document","createElement","docFragment","createDocumentFragment","appendChild","getContext","addEventListener","onResize","componentWillUnmount","removeEventListener","measureWidth","text","Math","ceil","measureText","width","getRenderText","_this$props","containerClassName","element","line","textElement","textTruncateChild","truncateText","maxCalculateTimes","scopeWidth","getBoundingClientRect","childText","type","children","currentPos","maxTextLength","truncatedText","splitPos","startPos","displayLine","lastIsEng","isPrevLineWithoutSpace","lastPos","lastSpaceIndex","ext","loopCnt","substr","lastIndexOf","render","_this2","_this$props2","_this$props2$style","fontWeight","fontStyle","fontSize","fontFamily","renderText","rootProps","ref","el","className","overflow","Component","string","oneOfType","number","bool","func","node","module"],"mappings":"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","sourcesContent":["\"use strict\";\n\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"exports\", \"react\", \"prop-types\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(exports, require(\"react\"), require(\"prop-types\"));\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports, global.React, global.propTypes);\n    global.undefined = mod.exports;\n  }\n})(void 0, function (exports, _react, _propTypes) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = undefined;\n\n  var _react2 = _interopRequireDefault(_react);\n\n  var _propTypes2 = _interopRequireDefault(_propTypes);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _typeof(obj) {\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  var TextTruncate = function (_Component) {\n    _inherits(TextTruncate, _Component);\n\n    function TextTruncate() {\n      var _getPrototypeOf2;\n\n      var _this;\n\n      _classCallCheck(this, TextTruncate);\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TextTruncate)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n      _defineProperty(_assertThisInitialized(_this), \"onResize\", function () {\n        if (_this.rafId) {\n          window.cancelAnimationFrame(_this.rafId);\n        }\n\n        _this.rafId = window.requestAnimationFrame(_this.update.bind(_assertThisInitialized(_this)));\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"onToggled\", function (truncated) {\n        typeof _this.props.onToggled === 'function' && setTimeout(function () {\n          return _this.props.onToggled(truncated);\n        }, 0);\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"onTruncated\", function () {\n        typeof _this.props.onTruncated === 'function' && setTimeout(function () {\n          return _this.props.onTruncated();\n        }, 0);\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"onCalculated\", function () {\n        typeof _this.props.onCalculated === 'function' && setTimeout(function () {\n          return _this.props.onCalculated();\n        }, 0);\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"update\", function () {\n        var style = window.getComputedStyle(_this.scope);\n        var font = [style['font-weight'], style['font-style'], style['font-size'], style['font-family'], style['letter-spacing']].join(' ');\n        _this.canvas.font = font;\n\n        _this.forceUpdate();\n      });\n\n      return _this;\n    }\n\n    _createClass(TextTruncate, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        var canvas = document.createElement('canvas');\n        var docFragment = document.createDocumentFragment();\n        var style = window.getComputedStyle(this.scope);\n        var font = [style['font-weight'], style['font-style'], style['font-size'], style['font-family']].join(' ');\n        docFragment.appendChild(canvas);\n        this.canvas = canvas.getContext('2d');\n        this.canvas.font = font;\n        this.forceUpdate();\n        window.addEventListener('resize', this.onResize);\n      }\n    }, {\n      key: \"componentWillUnmount\",\n      value: function componentWillUnmount() {\n        window.removeEventListener('resize', this.onResize);\n\n        if (this.rafId) {\n          window.cancelAnimationFrame(this.rafId);\n        }\n      }\n    }, {\n      key: \"measureWidth\",\n      value: function measureWidth(text) {\n        return Math.ceil(this.canvas.measureText(text).width);\n      }\n    }, {\n      key: \"getRenderText\",\n      value: function getRenderText() {\n        var _this$props = this.props,\n            containerClassName = _this$props.containerClassName,\n            element = _this$props.element,\n            line = _this$props.line,\n            onCalculated = _this$props.onCalculated,\n            onTruncated = _this$props.onTruncated,\n            onToggled = _this$props.onToggled,\n            text = _this$props.text,\n            textElement = _this$props.textElement,\n            textTruncateChild = _this$props.textTruncateChild,\n            truncateText = _this$props.truncateText,\n            maxCalculateTimes = _this$props.maxCalculateTimes,\n            props = _objectWithoutProperties(_this$props, [\"containerClassName\", \"element\", \"line\", \"onCalculated\", \"onTruncated\", \"onToggled\", \"text\", \"textElement\", \"textTruncateChild\", \"truncateText\", \"maxCalculateTimes\"]);\n\n        var scopeWidth = this.scope.getBoundingClientRect().width; // return if display:none\n\n        if (scopeWidth === 0) {\n          return null;\n        } // return if all of text can be displayed\n\n\n        if (scopeWidth >= this.measureWidth(text)) {\n          this.onToggled(false);\n          return (0, _react.createElement)(textElement, props, text);\n        }\n\n        var childText = '';\n\n        if (textTruncateChild && typeof textTruncateChild.type === 'string') {\n          var type = textTruncateChild.type;\n\n          if (type.indexOf('span') >= 0 || type.indexOf('a') >= 0) {\n            childText = textTruncateChild.props.children;\n          }\n        }\n\n        var currentPos = 1;\n        var maxTextLength = text.length;\n        var truncatedText = '';\n        var splitPos = 0;\n        var startPos = 0;\n        var displayLine = line;\n        var width = 0;\n        var lastIsEng = false;\n        var isPrevLineWithoutSpace = false;\n        var lastPos = 0;\n        var lastSpaceIndex = -1;\n        var ext = '';\n        var loopCnt = 0;\n\n        while (displayLine-- > 0) {\n          ext = displayLine ? '' : truncateText + (childText ? ' ' + childText : '');\n\n          while (currentPos <= maxTextLength) {\n            truncatedText = text.substr(startPos, currentPos);\n            width = this.measureWidth(truncatedText + ext);\n\n            if (width < scopeWidth) {\n              splitPos = text.indexOf(' ', currentPos + 1);\n\n              if (splitPos === -1) {\n                currentPos += 1;\n                lastIsEng = false;\n              } else {\n                lastIsEng = true;\n                currentPos = splitPos;\n              }\n            } else {\n              do {\n                if (loopCnt++ >= maxCalculateTimes) {\n                  break;\n                }\n\n                truncatedText = text.substr(startPos, currentPos);\n\n                if (!displayLine) {\n                  currentPos--;\n                }\n\n                if (truncatedText[truncatedText.length - 1] === ' ') {\n                  truncatedText = text.substr(startPos, currentPos - 1);\n                }\n\n                if (lastIsEng) {\n                  lastSpaceIndex = truncatedText.lastIndexOf(' ');\n\n                  if (lastSpaceIndex > -1) {\n                    currentPos = lastSpaceIndex;\n\n                    if (displayLine) {\n                      currentPos++;\n                    }\n\n                    truncatedText = text.substr(startPos, currentPos);\n                  } else {\n                    currentPos--;\n                    truncatedText = text.substr(startPos, currentPos);\n                  }\n                } else {\n                  currentPos--;\n                  truncatedText = text.substr(startPos, currentPos);\n                }\n\n                width = this.measureWidth(truncatedText + ext);\n              } while (width >= scopeWidth && truncatedText.length > 0);\n\n              startPos += currentPos;\n              break;\n            }\n          }\n\n          if (currentPos >= maxTextLength) {\n            startPos = maxTextLength;\n            break;\n          }\n\n          if (lastIsEng && !isPrevLineWithoutSpace && text.substr(lastPos, currentPos).indexOf(' ') === -1) {\n            isPrevLineWithoutSpace = text.substr(lastPos, currentPos).indexOf(' ') === -1;\n            displayLine--;\n          }\n\n          lastPos = currentPos + 1;\n        }\n\n        if (startPos === maxTextLength) {\n          this.onToggled(false);\n          return (0, _react.createElement)(textElement, props, text);\n        }\n\n        this.onTruncated();\n        this.onToggled(true);\n        return _react2[\"default\"].createElement(\"span\", props, (0, _react.createElement)(textElement, props, text.substr(0, startPos) + truncateText + ' '), textTruncateChild);\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var _this2 = this;\n\n        var _this$props2 = this.props,\n            element = _this$props2.element,\n            text = _this$props2.text,\n            _this$props2$style = _this$props2.style,\n            style = _this$props2$style === void 0 ? {} : _this$props2$style,\n            containerClassName = _this$props2.containerClassName,\n            line = _this$props2.line,\n            onCalculated = _this$props2.onCalculated,\n            onTruncated = _this$props2.onTruncated,\n            onToggled = _this$props2.onToggled,\n            textElement = _this$props2.textElement,\n            textTruncateChild = _this$props2.textTruncateChild,\n            truncateText = _this$props2.truncateText,\n            maxCalculateTimes = _this$props2.maxCalculateTimes,\n            props = _objectWithoutProperties(_this$props2, [\"element\", \"text\", \"style\", \"containerClassName\", \"line\", \"onCalculated\", \"onTruncated\", \"onToggled\", \"textElement\", \"textTruncateChild\", \"truncateText\", \"maxCalculateTimes\"]);\n\n        var fontWeight = style.fontWeight,\n            fontStyle = style.fontStyle,\n            fontSize = style.fontSize,\n            fontFamily = style.fontFamily;\n        var renderText = this.scope && line ? this.getRenderText() : (0, _react.createElement)(textElement, props, text);\n        ;\n        var rootProps = {\n          ref: function ref(el) {\n            _this2.scope = el;\n          },\n          className: containerClassName,\n          style: {\n            overflow: 'hidden',\n            fontWeight: fontWeight,\n            fontStyle: fontStyle,\n            fontSize: fontSize,\n            fontFamily: fontFamily\n          }\n        };\n        this.scope && this.onCalculated();\n        return (0, _react.createElement)(element, rootProps, renderText);\n      }\n    }]);\n\n    return TextTruncate;\n  }(_react.Component);\n\n  _defineProperty(TextTruncate, \"propTypes\", {\n    containerClassName: _propTypes2[\"default\"].string,\n    element: _propTypes2[\"default\"].string,\n    line: _propTypes2[\"default\"].oneOfType([_propTypes2[\"default\"].number, _propTypes2[\"default\"].bool]),\n    onCalculated: _propTypes2[\"default\"].func,\n    onTruncated: _propTypes2[\"default\"].func,\n    onToggled: _propTypes2[\"default\"].func,\n    text: _propTypes2[\"default\"].string,\n    textElement: _propTypes2[\"default\"].node,\n    textTruncateChild: _propTypes2[\"default\"].node,\n    truncateText: _propTypes2[\"default\"].string,\n    maxCalculateTimes: _propTypes2[\"default\"].number\n  });\n\n  _defineProperty(TextTruncate, \"defaultProps\", {\n    element: 'div',\n    line: 1,\n    text: '',\n    textElement: 'span',\n    truncateText: '…',\n    maxCalculateTimes: 10\n  });\n\n  exports.default = TextTruncate;\n  ;\n  module.exports = exports.default;\n});\n"]},"metadata":{},"sourceType":"script"}